import {SampleSequencer} from "./sampleSequencer.js";

export const PromptSamples = [
  {
    name: "Ad Lib",
    filename: "static/audio/prompts/dynamic/English Female - Ad Lib.wav"
  }, {
    name: "All In",
    filename: "static/audio/prompts/dynamic/English Female - All In.wav"

  }, {
    name: "Bass",
    filename: "static/audio/prompts/dynamic/English Female - Bass.wav"
  }, {
    name: "Big Ending",
    filename: "static/audio/prompts/dynamic/English Female - Big Ending.wav"

  }, {
    name: "Break",
    filename: "static/audio/prompts/dynamic/English Female - Break.wav"

  }, {
    name: "Build",
    filename: "static/audio/prompts/dynamic/English Female - Build.wav"

  }, {
    name: "Drums In",
    filename: "static/audio/prompts/dynamic/English Female - Drums In.wav"

  }, {
    name: "Drums",
    filename: "static/audio/prompts/dynamic/English Female - Drums.wav"

  }, {
    name: "Hits",
    filename: "static/audio/prompts/dynamic/English Female - Hits.wav"
  }, {
    name: "Hold",
    filename: "static/audio/prompts/dynamic/English Female - Hold.wav"
  }, {
    name: "Key Change Down",
    filename: "static/audio/prompts/dynamic/English Female - Key Change Down.wav"
  }, {
    name: "Key Change Up",
    filename: "static/audio/prompts/dynamic/English Female - Key Change Up.wav"
  }, {
    name: "Keys",
    filename: "static/audio/prompts/dynamic/English Female - Keys.wav"
  }, {
    name: "Last Time",
    filename: "static/audio/prompts/dynamic/English Female - Last Time.wav"
  }, {
    name: "Slowly Build",
    filename: "static/audio/prompts/dynamic/English Female - Slowly Build.wav"
  }, {
    name: "Softly",
    filename: "static/audio/prompts/dynamic/English Female - Softly.wav"
  }, {
    name: "Swell",
    filename: "static/audio/prompts/dynamic/English Female - Swell.wav"
  }, {
    name: "Worship Freely",
    filename: "static/audio/prompts/dynamic/English Female - Worship Freely.wav"
  }, {
    name: "1",
    filename: "static/audio/prompts/sections/English Female - 1.wav"
  }, {
    name: "2",
    filename: "static/audio/prompts/sections/English Female - 2.wav"
  }, {
    name: "3",
    filename: "static/audio/prompts/sections/English Female - 3.wav"
  }, {
    name: "4",
    filename: "static/audio/prompts/sections/English Female - 4.wav"
  }, {
    name: "5",
    filename: "static/audio/prompts/sections/English Female - 5.wav"
  }, {
    name: "6",
    filename: "static/audio/prompts/sections/English Female - 6.wav"
  }, {
    name: "7",
    filename: "static/audio/prompts/sections/English Female - 7.wav"
  }, {
    name: "Acapella",
    filename: "static/audio/prompts/sections/English Female - Acapella.wav"
  }, {
    name: "Breakdown",
    filename: "static/audio/prompts/sections/English Female - Breakdown.wav"
  }, {
    name: "Bridge 1",
    filename: "static/audio/prompts/sections/English Female - Bridge 1.wav"
  }, {
    name: "Bridge 2",
    filename: "static/audio/prompts/sections/English Female - Bridge 2.wav"
  }, {
    name: "Bridge 3",
    filename: "static/audio/prompts/sections/English Female - Bridge 3.wav"
  }, {
    name: "Bridge 4",
    filename: "static/audio/prompts/sections/English Female - Bridge 4.wav"
  }, {
    name: "Bridge",
    filename: "static/audio/prompts/sections/English Female - Bridge.wav"
  }, {
    name: "Chorus 1",
    filename: "static/audio/prompts/sections/English Female - Chorus 1.wav"
  }, {
    name: "Chorus 2",
    filename: "static/audio/prompts/sections/English Female - Chorus 2.wav"
  }, {
    name: "Chorus 3",
    filename: "static/audio/prompts/sections/English Female - Chorus 3.wav"
  }, {
    name: "Chorus 4",
    filename: "static/audio/prompts/sections/English Female - Chorus 4.wav"
  }, {
    name: "Chorus",
    filename: "static/audio/prompts/sections/English Female - Chorus.wav"
  }, {
    name: "Ending",
    filename: "static/audio/prompts/sections/English Female - Ending.wav"
  }, {
    name: "Exhortation",
    filename: "static/audio/prompts/sections/English Female - Exhortation.wav"
  }, {
    name: "Instrumental",
    filename: "static/audio/prompts/sections/English Female - Instrumental.wav"
  }, {
    name: "Interlude",
    filename: "static/audio/prompts/sections/English Female - Interlude.wav"
  }, {
    name: "Intro",
    filename: "static/audio/prompts/sections/English Female - Intro.wav"
  }, {
    name: "Outro",
    filename: "static/audio/prompts/sections/English Female - Outro.wav"
  }, {
    name: "Post Chorus",
    filename: "static/audio/prompts/sections/English Female - Post Chorus.wav"
  }, {
    name: "Pre Chorus 1",
    filename: "static/audio/prompts/sections/English Female - Pre Chorus 1.wav"
  }, {
    name: "Pre Chorus 2",
    filename: "static/audio/prompts/sections/English Female - Pre Chorus 2.wav"
  }, {
    name: "Pre Chorus 3",
    filename: "static/audio/prompts/sections/English Female - Pre Chorus 3.wav"
  }, {
    name: "Pre Chorus 4",
    filename: "static/audio/prompts/sections/English Female - Pre Chorus 4.wav"
  }, {
    name: "Pre Chorus",
    filename: "static/audio/prompts/sections/English Female - Pre Chorus.wav"
  }, {
    name: "Rap",
    filename: "static/audio/prompts/sections/English Female - Rap.wav"
  }, {
    name: "Refrain",
    filename: "static/audio/prompts/sections/English Female - Refrain.wav"
  }, {
    name: "Solo",
    filename: "static/audio/prompts/sections/English Female - Solo.wav"
  }, {
    name: "Tag",
    filename: "static/audio/prompts/sections/English Female - Tag.wav"
  }, {
    name: "Turnaround",
    filename: "static/audio/prompts/sections/English Female - Turnaround.wav"
  }, {
    name: "Vamp",
    filename: "static/audio/prompts/sections/English Female - Vamp.wav"
  }, {
    name: "Verse 1",
    filename: "static/audio/prompts/sections/English Female - Verse 1.wav"
  }, {
    name: "Verse 2",
    filename: "static/audio/prompts/sections/English Female - Verse 2.wav"
  }, {
    name: "Verse 3",
    filename: "static/audio/prompts/sections/English Female - Verse 3.wav"
  }, {
    name: "Verse 4",
    filename: "static/audio/prompts/sections/English Female - Verse 4.wav"
  }, {
    name: "Verse 5",
    filename: "static/audio/prompts/sections/English Female - Verse 5.wav"
  }, {
    name: "Verse 6",
    filename: "static/audio/prompts/sections/English Female - Verse 6.wav"
  }, {
    name: "Verse",
    filename: "static/audio/prompts/sections/English Female - Verse.wav"
  }
];

export class Prompts extends SampleSequencer {
  
  constructor(scheduler, config) {
    
    super(scheduler, config);
    
    this._setupEventListeners();
  }
  
  _setupEventListeners() {
    this._scheduler.addEventListener("prompt", this._schedulePrompt.bind(this));
  }
  
  async _schedulePrompt(e) {
    let prompts = [];
    
    if (e.detail.item.prompts) {
      prompts = e.detail.item.prompts;
    }
    
    if (e.detail.item.prompt) {
      prompts.push(e.detail.item.prompt);
    }
    if (prompts.length > 0) {
      let beats = await this._getBeats(prompts, e.detail.item.prompt.count);
      this._scheduler.scheduleNextBar(beats);
    }
  }
  
  async _getBeats(prompts, count = false) {
    let beats = [];
    
    let iterations = count ? this._scheduler.timeSignature.upper : prompts.length;
    
    for (let i = 1; i <= iterations; i++) {
      let beat = {};
      beat.beat = i;
      
      if (i <= prompts.length) {
        beat.audio = await this._createSampleNode(prompts[i - 1].name);
      } else {
        beat.audio = await this._createSampleNode(`${i}`, {gain: 0.5});
      }
      
      beats.push(beat);
    }
    
    return beats;
  }
  
  _nextBar(e) {
    //do nothing
  }

}

/*
[
  {
    command: setTempo,
    data: {
      bpm: Number
    }
  },
  {
    command: setTimeSignature,
    data: {
      upper: Number,
      lower: Number
    }
  },
  {
    command: start
  },
  {
    command: stop
  }
  {
    audio: AudioNode,
    // floating point number
    beat: 
  }
]
*/